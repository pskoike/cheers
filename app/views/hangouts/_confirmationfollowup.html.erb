<div class="hangout-title">
  <h1><%=@hangout.title%></h1>
  <h1><%=@radius%></h1>
  <%= image_tag @hangout.user.facebook_picture_url, class: "avatar"%>
</div>

<div id="map" style="width: 100%; height: 300px;"></div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).ready(function initMap() {
      console.log('HELLO')
      var markers = (<%= raw @confirmation_markers.to_json %>);
      var bounds = new google.maps.LatLngBounds();

      markers.forEach(function(marker) {
        var marker = new google.maps.Marker({
          position: {lat: marker.lat, lng: marker.lng},
          map: map,
        });
      bounds.extend(marker.position);
      });

      console.log(<%= @confirmation_markers.count%>)

      if ( <%= @confirmation_markers.count%> > 1) {
        map.fitBounds(bounds);
        var center = (<%= raw @center.to_json %>);
        var cityCircle = new google.maps.Circle({
          strokeColor: '#FF0000',
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: '#FF0000',
          fillOpacity: 0.35,
          map: map,
          center: {lat: center.lat, lng: center.lng},
          radius: <%=@radius%>
        });

        var center = (<%= raw @adj_center.to_json %>);
        var cityCircle = new google.maps.Circle({
          strokeColor: '#000000',
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: '#B3FFA2',
          fillOpacity: 0.35,
          map: map,
          center: {lat: center.lat, lng: center.lng},
          radius: <%=@radius%>
        });
      }
      else {
        map.setZoom(14);
        console.log('lat:' + ''  + markers[0].lat)
        map.panTo({lat: markers[0].lat, lng: markers[0].lng})
      };
    });
  <% end %>
<% end %>

<div class="row">
  <div class="col-xs-4">
    <div class="text-center calendar-wrapper">
      <p><%=@hangout.category%></p>
      <%= image_tag 'calendar.png', class: "calendar"%>
      <p><%=@hangout.date.strftime('%d %b, %Y')%></p>
      <p><%=@hangout.date.strftime('%I:%M%P')%></p>
    </div>
  </div>
  <div class="col-xs-8">
    <ul class="guest">
      <% @confirmations.each do |confirmation| %>
        <p> <%= image_tag confirmation.user.facebook_picture_url, class: "avatar"%>
        <%= "#{confirmation.user.first_name} #{confirmation.user.last_name}"%></p>
      <%end%>
    </ul>
  </div>
</div>

<% if @hangout.user == current_user %>
  <%= button_to "share", share_hangout_path(@hangout), method: :get, class: "btn btn-success" %> <br>
  <%= button_to t('.button_launch_vote'), launch_vote_hangout_path(@hangout), method: :patch, class: "btn btn-success" %>
  <%= link_to edit_hangout_path(@hangout), class: "btn btn-danger" do %>
    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
  <% end %>
  <%= button_to cancel_hg_hangout_path(@hangout),class:"btn btn-danger", method: :patch, data: { confirm: t('.alert_delete') } do %><i class="fa fa-trash-o" aria-hidden="true"></i><% end %>
<% end %>
